---
title: chkdsk
description: 'Windows 命令主题 * * *- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 62912a3c-d2cc-4ef6-9679-43709a286035
author: coreyp-at-msft
ms.author: coreyp
manager: lizapo
ms.date: 10/16/2017
ms.openlocfilehash: 26aad48db4a5f0a593dfcb29160031a0c9f3dc75
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/17/2019
ms.locfileid: "59886858"
---
# <a name="chkdsk"></a>chkdsk



检查文件系统和文件系统元数据的卷的逻辑和物理错误。 如果使用不带参数， **chkdsk**显示仅卷的状态并不能解决任何错误。 如果用于 **/f**， **/r**， **/x**，或者**b </b**参数，它在卷上修复错误。

> [!IMPORTANT]
> 本地成员资格**管理员**组中或等效身份是运行所需的最低**chkdsk**。 若要打开命令提示符窗口，以管理员身份，请右键单击**命令提示符**在开始菜单，然后单击**以管理员身份运行**。

> [!IMPORTANT]
> 中断**chkdsk**不建议。 但是，正在取消或中断**chkdsk**不应离开该卷比之前更任何损坏**chkdsk**已运行。 重新运行**chkdsk**检查并修复任何剩余卷上的损坏。

> [!IMPORTANT]
> **注意：** Chkdsk 可仅为本地磁盘。 该命令不能用于在网络上已重定向本地驱动器号。

有关如何使用此命令的示例，请参阅[示例](#BKMK_examples)。

##<a name="syntax"></a>语法

```
chkdsk [<Volume>[[<Path>]<FileName>]] [/f] [/v] [/r] [/x] [/i] [/c] [/l[:<Size>]] [/b]  

```

##<a name="parameters"></a>Parameters

|参数|描述|
|---------|-----------|
|\<卷 >|指定 （后跟一个冒号） 的驱动器号，装入点或卷名称。|
|[\<Path>]<FileName>|用于文件分配表 (FAT) 和仅 FAT32。 指定的位置和文件的名称或一组所需的文件**chkdsk**要检查碎片。 可以使用 **？** 并 **&#42;** 通配符指定多个文件。|
|/f|在磁盘上修复错误。 该磁盘必须锁定。 如果**chkdsk**不能的锁定驱动器，一条消息将出现，询问你是否想要检查驱动器下一次重新启动计算机。|
|/v|检查磁盘，每个目录中显示每个文件的名称。|
|/r|找到坏扇区并恢复可读信息。 该磁盘必须锁定。 **/r**包括的功能 **/f**，其他分析的物理磁盘错误。|
|/x|强制该卷卸载首先，如有必要。 到驱动器的所有打开的句柄均无效。 **/x**还包括的功能 **/f**。|
|i|仅用于 NTFS。 执行充分检查索引条目，从而减少了运行所需的时间量**chkdsk**。|
|/c|仅用于 NTFS。 不会检查周期内的文件夹结构，从而减少了运行所需的时间量**chkdsk**。|
|/l[:\<Size>]|仅用于 NTFS。 日志文件大小更改为用户输入的大小。 如果省略该参数， **/l**显示当前大小。|
|/b|仅限 NTFS:清除不正确的卷上的群集的列表和反复扫描错误的所有已分配和可用群集。 **/b**包括的功能 **/r**。 图像处理到新的硬盘驱动器上的卷之后，使用此参数。|
|/?|在命令提示符下显示帮助。|

##<a name="remarks"></a>备注

-   正在跳过卷检查

    **/I**或 **/c**交换机可以减少运行所需的时间量**chkdsk**通过跳过某些批量检查。
-   检查在重新启动时锁定的驱动器

    如果你想**chkdsk**若要更正磁盘错误，不能有打开的文件的驱动器上。 如果文件处于打开状态，将出现以下错误消息：  
    ```
    Chkdsk cannot run because the volume is in use by another process. Would you like to schedule this volume to be checked the next time the system restarts? (Y/N)  
    
    ```  
    如果选择在的下次重新启动计算机，检查驱动器**chkdsk**检查驱动器并重新启动计算机时自动更正错误。 如果驱动器分区是启动分区**chkdsk**自动重新启动计算机后它会检查该驱动器。

    此外可以使用**chkntfs /c**命令来计划卷以检查下一次重新启动计算机。 使用**fsutil 脏集**命令将卷设置的脏位 （指示损坏），因此，该 Windows 运行**chkdsk**重新启动计算机。
-   报告磁盘错误

    应使用**chkdsk**偶尔在 FAT 和 NTFS 文件系统来检查磁盘错误。 **Chkdsk**检查磁盘空间和磁盘使用情况并提供特定于每个文件系统的状态报告。 在状态报告显示在文件系统中发现错误。 如果在运行**chkdsk**而无需 **/f**参数在活动分区，则可能会报告虚假错误，因为它不能锁定驱动器。
-   修复逻辑磁盘错误

    **Chkdsk**更正逻辑磁盘错误，仅当你指定 **/f**参数。 **Chkdsk**必须能够锁定驱动器，若要更正错误。

    修复在 FAT 文件系统上的通常会更改磁盘的文件分配表，有时会导致丢失数据，因为**chkdsk**可能会显示类似于以下一条确认消息：  
    ```
    10 lost allocation units found in 3 chains.  
    Convert lost chains to files?  
    
    ```  
    如果按下**Y**，Windows 将每个丢失的链的根目录中保存为具有格式文件的名称的文件\<nnnn >.chk。 当**chkdsk**完成之后，可以检查这些文件，请参阅是否包含所需的任何数据。 如果按下**N**、 Windows 修补程序的磁盘，但它不会保存丢失的分配单元的内容。

    如果不使用 **/f**参数， **chkdsk**显示一条消息，该文件必须保持不变，但不能解决任何错误。

    如果您使用**chkdsk /f**非常大的磁盘或具有大量的文件 （例如，数以百万计的文件），磁盘上**chkdsk /f**可能需要很长时间才能完成。
-   发现物理磁盘错误

    使用 **/r**参数查找文件系统中的物理磁盘错误，并尝试恢复数据从任何受影响的磁盘扇区。
-   使用**chkdsk**与打开的文件

    如果指定 **/f**参数， **chkdsk**不在磁盘上打开的文件时显示一条错误消息。 如果未指定 **/f**参数，并打开的文件存在， **chkdsk**可能会在磁盘上报告丢失的分配单元。 这可能是如果打开文件具有不被记录在文件分配表中。 如果**chkdsk**报告丢失的大量的分配单元，请考虑修复该磁盘。
-   使用**chkdsk**使用共享文件夹的卷影副本

    因为对于启用了共享文件夹，共享文件夹源卷的卷影副本不能锁定卷影副本时，运行**chkdsk**对源卷可能会报告虚假错误或者导致**chkdsk**意外退出。 但是，可以通过运行检查是否有错误的卷影副本**chkdsk**在只读模式下 （不带参数） 来检查共享文件夹存储卷的卷影副本。
-   了解退出代码

    下表列出了退出代码**chkdsk**报告完成之后。  
    |退出代码|描述|
    |---------|-----------|
    |0|未发现错误。|
    |1|已发现了错误，并且已修复。|
    |2|执行磁盘清理 （如垃圾收集） 或未执行清除，因为 **/f**未指定。|
    |3|无法检查该磁盘，不会修复错误，或由于错误未修复 **/f**未指定。|
-   **Chkdsk**命令，使用不同的参数，可从恢复控制台。
-   很少重新启动的服务器上，你可能想要使用**chkntfs**或**fsutil 脏查询**命令来确定该卷的脏位是否已在运行 chkdsk 之前设置。

## <a name="BKMK_examples"></a>示例

如果你想要检查驱动器 D 中的磁盘，并具有 Windows 修复错误，请键入：
```
chkdsk d: /f  

```
如果遇到错误， **chkdsk**暂停，并显示消息。 **Chkdsk**最后会显示一个报表，列出的磁盘的状态。 无法打开之前指定的驱动器上的任何文件**chkdsk**完成。

若要检查当前目录中的 FAT 磁盘上的非邻接块的所有文件，请键入：
```
chkdsk *.*  

```
**Chkdsk**显示状态报告，，然后列出与具有非连续的块的文件规范匹配的文件。
#### <a name="additional-references"></a>其他参考

[命令行语法解答](command-line-syntax-key.md)
