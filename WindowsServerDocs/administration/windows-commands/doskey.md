---
title: doskey
description: 'Windows 命令主题 * * *- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 4874fd43-d5ea-45f3-ae24-388ae925ed76
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 61629a6122ec83cae35a8797966ef3d712ee5808
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/17/2019
ms.locfileid: "59825858"
---
# <a name="doskey"></a>doskey



调用的 Doskey.exe （以前的重新调用输入的命令行命令），编辑命令行，并创建宏。

有关如何使用此命令的示例，请参阅[示例](#BKMK_examples)。

## <a name="syntax"></a>语法

```
doskey [/reinstall] [/listsize=<Size>] [/macros:[all | <ExeName>] [/history] [/insert | /overstrike] [/exename=<ExeName>] [/macrofile=<FileName>] [<MacroName>=[<Text>]]
```

## <a name="parameters"></a>Parameters

|参数|描述|
|---------|-----------|
|/reinstall|安装了一个新的 Doskey.exe 并清除命令历史记录缓冲区。|
|/listsize=\<Size>|历史记录缓冲区中指定的最大命令数。|
|/macros|显示所有的列表**doskey**宏。 你可以使用重定向符号 (**>**) 与 **/macros**重定向到文件的列表。 你可以将缩写 **/macros**到 **/m**。|
|/macros:all|显示**doskey**用于所有可执行文件的宏。|
|/macros:\<ExeName >|显示**doskey**用于指定的可执行文件的宏*ExeName*。|
|/history|显示存储在内存中的所有命令。 你可以使用重定向符号 (**>**) 与 **/history**重定向到文件的列表。 你可以将缩写 **/history**作为 **/h**。|
|[/insert | /overstrike]|指定是否要插入或覆盖你键入的文本。 如果您使用 **/插入**，新行中键入的文本插入到现有的文本的常客。 如果您使用 **/重叠**、 新文本替换现有文本。 默认设置是 **/重叠**。|
|/exename=\<ExeName>|指定的程序 (即，可执行文件) 所在**doskey**宏运行。|
|/macrofile=\<FileName>|指定包含你想要安装的宏的文件。|
|\<MacroName>=[<Text>]|创建由指定的命令将执行宏*文本*。 *MacroName*指定想要分配给该宏的名称。 *文本*指定你想要记录的命令。 如果*文本*保留为空， *MacroName*的已分配的任何命令均已清除。|
|/?|在命令提示符下显示帮助。|

## <a name="remarks"></a>备注

-   使用 Doskey.exe

    Doskey.exe 始终是可用于所有基于字符的、 交互式程序 （如程序调试程序或文件传输程序），并且还可保留命令历史记录缓冲区和用于启动每个程序的宏。 不能使用**doskey**从程序的命令行选项。 您必须运行**doskey**之前启动的程序的命令行选项。 重写程序键分配**doskey**密钥分配。
-   撤回命令

    若要重新调用命令，你可以在启动 Doskey.exe 后使用任何以下项。 如果在程序内使用 Doskey.exe，该程序的键分配更高优先级。  
    |键|描述|
    |---|-----------|
    |向上键|调用之前将显示一个使用该命令。|
    |向下键|调用后将显示一个使用该命令。|
    |Page Up|调用上使用当前会话中的第一个命令。|
    |Page Down|调用当前会话中使用的最新命令。|
-   编辑命令行

    使用 Doskey.exe，可以编辑当前的命令行。 如果在程序内使用 Doskey.exe，该程序的键分配更高优先级，可能无法运行某些 Doskey.exe 编辑项。

    下表列出**doskey**编辑密钥和及其功能。  
    |键或键组合|描述|
    |----------------------|-----------|
    |向左键|将移动插入点退后一个字符。|
    |向右键|将插入点向前一个字符。|
    |CTRL + 向左键|将移动插入点返回一个单词。|
    |CTRL + 向右键|将移动插入点向前一个单词。|
    |Home|将插入点移动到行的开头。|
    |End|将插入点移动到行尾。|
    |ESC|清除从显示的命令。|
    |F1|将一个字符从模板中的列复制到命令提示符窗口中的同一列。 （该模板是包含您键入的最后一个命令的内存缓冲区。）|
    |F2|向前搜索后你键入的下一个键在模板中按 F2。 Doskey.exe 将文本插入模板中-到，但不是包括，指定字符。|
    |F3|将模板的其余部分复制到命令行。 Doskey.exe 从开始复制字符相对应的模板中的位置插入点在命令行上指示的位置。|
    |F4|删除所有字符在当前插入都点位置到，但不是包括后你键入的字符的下一个匹配项按 F4。|
    |F5|将模板复制到当前的命令行。|
    |F6|将文件尾字符 (CTRL + Z) 放置在当前插入点位置。|
    |F7|（在对话框中） 显示此程序在内存中存储的所有的命令。 使用向上键和向下箭头键来选择所需的命令，然后按 enter 键以运行命令。 此外可以记下该命令前面的顺序号，并结合使用此数字 F9 键。|
    |ALT+F7|删除存储在当前的历史记录缓冲区的内存中的所有命令。|
    |F8|显示所有命令中的历史记录缓冲区的当前命令中的字符开头。|
    |F9|将提示你提供历史记录缓冲区命令编号，然后显示与你指定的号关联的命令。 按 ENTER 以运行该命令。 若要显示的数字和其关联的命令，请按 F7。|
    |ALT+F10|删除所有的宏定义。|
-   使用**doskey**在程序中

    某些基于字符的、 交互式程序，如程序调试程序或文件传输程序 (FTP) 将自动使用 Doskey.exe。 若要使用 Doskey.exe，程序必须是一个控制台的过程，并使用缓冲的输入。 重写程序键分配**doskey**密钥分配。 例如，如果程序使用 F7 键的函数，则不能获得**doskey**命令弹出窗口中的历史记录。

    通过 Doskey.exe，可以维护每个程序启动或重复的命令历史记录。 可以编辑在程序的提示符下，以前的命令和启动**doskey**为程序创建的宏。 如果您退出然后重新启动程序的命令提示符窗口中，从上一个程序会话的命令历史记录是可用。

    您必须运行 Doskey.exe，然后启动程序。 不能使用**doskey**命令行选项从程序的命令提示符，即使程序具有 shell 命令。

    如果你想要自定义 Doskey.exe 与程序的工作方式，并创建**doskey**用于该程序的宏，可以创建一个批处理程序来修改 Doskey.exe 并启动的程序。
-   指定默认值插入模式

    如果按 INSERT 键，也可以在键入的文本**doskey**过程而不替换文本的现有文本的命令行。 但是，按 ENTER 后，Doskey.exe 返回键盘到替换模式。 必须按 INSERT 再次以返回到插入模式。

    使用 **/插入**若要切换到插入模式下的键盘每次您按 ENTER。 键盘有效地保持在插入模式下则直到您使用 **/重叠**。 暂时可以通过按 INSERT 键返回到替换模式但 Doskey.exe 按 ENTER 后，返回键盘插入模式。

    插入点更改形状时使用 INSERT 键从一种模式更改为其他。
-   创建一个宏

    Doskey.exe 可用于创建执行一个或多个命令的宏。 下表列出了可用于控制命令操作时定义的宏的特殊字符。  
    |字符|描述|
    |---------|-----------|
    |$G 或 $g|将输出重定向。 使用任一特殊字符将输出发送到设备还是文件而不是屏幕。 此字符相当于输出重定向符号 (**>**)。|
    |$G$ G 或 $g$ g|将输出追加到文件末尾。 使用任一双字符将输出追加到现有文件而不是替换文件中的数据。 这些双引号字符都与输出追加重定向符号 (**>>**)。|
    |$L 或 $l|输入的重定向。 使用任一特殊字符读取从设备或文件，而不是从键盘输入。 此字符相当于输入的重定向符号 (**<**)。|
    |$B 或 $b|将宏输出发送到命令。 这些特殊字符是等效于使用管道 (* *|*） 命令行上。|
    |$T 或 $t|分隔命令。 使用这些特殊字符之一分隔命令时创建宏或上键入命令**doskey**命令行。 这些特殊字符是等效于使用 & 符 (**&**) 命令行上。|
    |$$|指定的美元符号字符 (**$**)。|
    |$ 1 直到 $9|表示你想要运行宏时指定的任何命令行信息。 特殊字符**1 美元**通过 **$9**是批参数，您可以在命令行上每次运行宏使用不同的数据。 **1 美元**中的字符**doskey**命令相当于 **%1**字符中的批处理程序。|
    |$*|表示所有你想要键入宏名称时指定的命令行信息。 特殊字符**$ \*** 是一个可替换参数，类似于批参数**1 美元**通过 **$9**，其中一个重要区别： 所有内容后宏名称替换为命令行上键入**$ \*** 宏中。|
-   运行**doskey**宏

    若要运行宏，请在命令提示符下，从第一个位置开始键入宏名称。 如果与定义了宏**$ \*** 或任何批参数**1 美元**通过 **$9**，使用空格来分隔参数。 不能运行**doskey**批处理程序中的宏。
-   使用 Windows Server 2003 家族命令相同的名称创建一个宏

    如果具有特定的命令行选项始终使用特定命令，可以创建具有与命令相同的名称的宏。 若要指定想要运行宏或命令，请遵循以下准则：  
    -   若要运行宏，请在命令提示符下键入宏名称。 不要添加宏名称前的空间。
    -   若要运行该命令，在命令提示符处，插入一个或多个空格，然后键入命令名称。
-   删除宏

    若要删除宏，请键入：  
    ```
    doskey <MacroName> =
    ```

## <a name="BKMK_examples"></a>示例

**/Macros**并 **/history**命令行选项可用于创建批处理程序来保存宏和命令。 例如，若要存储所有当前**doskey**宏中，键入：
```
doskey /macros > macinit 
```
若要使用存储在 Macinit 的宏，请键入：
```
doskey /macrofile=macinit 
```
若要创建一个批处理程序 tmp.bat 包含最近使用的命令，类型：
```
doskey /history> tmp.bat 
```
若要定义多个命令使用宏，请使用 **$t**若要将命令，按如下所示：
```
doskey tx=cd temp$tdir/w $*
```
在前面的示例中，TX 宏将当前目录更改到 Temp，然后显示的目录列表中范围的显示格式。 可以使用**$ \*** 宏要追加到其他命令行选项的末尾**dir** TX 的运行时。

下面的宏用于新的目录名称使用批参数：
```
doskey mc=md $1$tcd $1
```
宏将创建新目录，然后从当前目录更改到新目录。

若要使用以前的宏来创建和更改到名为 Books 的目录，键入：
```
mc books
```
若要创建**doskey**宏的程序名为 Ftp.exe、 包括 **/exename** ，如下所示：
```
doskey /exename=ftp.exe go=open 172.27.1.100$tmget *.TXT c:\reports$tbye 
```
若要使用以前的宏，启动 FTP。 在 FTP 提示符处，键入：
```
go
```
FTP 运行**打开**， **mget**，并**bye**命令。

若要创建快速和无条件地格式磁盘的宏，请键入：
```
doskey qf=format $1 /q /u
```
若要快速而无条件地设置格式的磁盘驱动器 A 中，键入：
```
qf a:
```
若要删除名为 vlist 宏，请键入：
```
doskey vlist =
```

#### <a name="additional-references"></a>其他参考

[命令行语法解答](command-line-syntax-key.md)