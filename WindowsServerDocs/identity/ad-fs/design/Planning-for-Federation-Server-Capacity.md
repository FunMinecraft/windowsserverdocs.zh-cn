---
ms.assetid: 7013fc21-9ced-4f9d-9588-cb04d6d60924
title: 联合服务器容量规划
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 569bea74fe7750eaf2b410a552876e0862b1e24b
ms.sourcegitcommit: 0b5fd4dc4148b92480db04e4dc22e139dcff8582
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/24/2019
ms.locfileid: "66191091"
---
# <a name="planning-for-federation-server-capacity"></a>联合服务器容量规划

联合身份验证服务器的容量规划可帮助你估计：  
  
-   哪些因素增长的 AD FS 配置数据库的大小。  
  
-   每个联合身份验证服务器的相应的硬件要求。  
  
-   要放置在每个组织中的联合服务器的数目。  
  
联合身份验证服务器向用户颁发安全令牌。 这些标记将提供给信赖方使用。 联合服务器颁发安全令牌对用户进行身份验证或之后接收之前由合作伙伴联合身份验证服务颁发的安全令牌。 当用户最初登录到联合应用程序时或在其安全令牌过期后，他们会访问联合应用程序时，将从联合身份验证服务请求安全令牌。  
  
联合身份验证服务器设计为可以容纳高\-使用 Microsoft 网络负载平衡的可用性服务器场配置\(NLB\)技术。 场配置中的联合身份验证服务器可以独立地服务请求，而无需访问每个请求的任何常用场组件。 因此，没有向外扩展联合身份验证服务器部署中涉及的小的开销。  
  
**建议：**  
  
-   为任务关键型\-严重或高\-可用性部署中，我们建议每个伙伴组织，与每个场，以便提供容错能力的至少两个联合身份验证服务器中创建小联合服务器场。  
  
-   具有高可用性，并且简化了向外扩展联合身份验证服务器的需要，向外扩展是用于处理大量的特定的联合身份验证服务的每秒请求的建议的方法。 本指南中的基本配置超出纵向扩展是不大可能产生大的容量处理提升。  
  
## <a name="ad-fs-configuration-database-size-and-growth"></a>AD FS 配置数据库大小和增长  
AD FS 配置数据库的大小通常被视为很小，并且数据库大小不会不倾向于在 AD FS 部署的主要考虑因素。  AD FS 配置数据库的精确大小可以依赖于信任关系和关联的信任关系的数量很大程度上\-相关的元数据，如声明、 声明规则，并监视每个信任配置的设置。 当配置数据库中的信任条目数的增长，也需要更多磁盘空间。  
  
有关 AD FS 配置数据库的其他部署信息，请参阅[AD FS 部署拓扑注意事项](AD-FS-Deployment-Topology-Considerations.md)。  
  
## <a name="memory-cpu-and-disk-space-requirements"></a>内存、 CPU 和磁盘空间要求  
幸运的是，联合身份验证服务器的内存、 CPU 和磁盘空间要求影响不大，并且不太可能是硬件决策的驱动因素。 有关硬件要求的详细信息，请参阅[附录 a:查看 AD FS 要求](Appendix-A--Reviewing-AD-FS-Requirements.md)。  
  
> [!NOTE]  
> 在 AD FS 产品团队使用专用的 SQL Server 使用配置的联合身份验证服务器场存储 AD FS 配置数据库所执行的测试中，SQL Server 上的全部负载就变得较低。 在一个测试使用四\-联合身份验证\-被配置为使用单个 SQL Server，CPU 使用率的服务器场不能超过 10%尽管经过测试的联合身份验证服务器进入目标利用率。  
  
## <a name="bk_estimatefs"></a>估计数为你的组织的联合身份验证服务器  
为了简化硬件规划联合服务器的过程，在 AD FS 产品团队形成了 AD FS 容量规划大小调整电子表格。 此 Excel 电子表格包括计算器\-等功能需要较长的预期使用情况数据的组织中提供有关用户和适用于你的 AD FS 生产环境中返回建议的联合身份验证服务器的最佳数目.  
  
> [!NOTE]  
> 建议将此电子表格的联合服务器的数目取决于 AD FS 产品团队在测试过程中使用的硬件和网络规范。 因此，建议将该电子表格的联合服务器的数目必须理解此上下文中。  有关在测试期间使用的规范的详细信息，请参阅标题为的主题[AD FS 服务器容量规划](Planning-for-AD-FS-Server-Capacity.md)。  
  
### <a name="using-the-ad-fs-capacity-planning-sizing-spreadsheet"></a>使用 AD FS 容量规划大小调整电子表格  
当使用此电子表格时，你将需要选择一个值\(任一**40%** ， **60%** ，或**80%** \)最符合需求的百分比预期的用户总数将高峰使用期间将身份验证请求发送到联合身份验证服务器。  
  
然后，你将需要选择一个值\(任一**1 分钟**， **15 分钟**，或**1 小时**\)最符合需求的预期的时间长度到最后一个高峰使用周期。 例如，你可能会估计 40%的人员将在 15 分钟的时间段内登录或 60%的用户将登录的 1 小时内的用户总数的值。 在一起，这些值定义大小调整建议将计算所依据的峰值负载配置文件。  
  
接下来，需要指定需要单一登录的用户总数\-上对目标声明的访问\-感知应用程序，根据用户是否：  
  
-   从本地计算机中以物理方式连接到公司网络登录到 Active Directory\(通过 Windows 集成身份验证\)  
  
-   不以物理方式连接到企业网络的计算机从远程登录到 Active Directory\(通过 Windows 集成身份验证或用户名和密码\)  
  
-   从另一个组织并尝试访问目标声明\-感知应用程序从受信任的合作伙伴  
  
-   从某个 SAML 2.0 标识提供者后，尝试访问目标声明\-感知应用程序  
  
#### <a name="how-to-use-this-spreadsheet"></a>如何使用此电子表格  
每个联合服务器场实例你打算部署以确定联合身份验证服务器的建议的数目，可以使用以下步骤。  
  
1.  下载并打开[AD FS 容量规划大小调整电子表格适用于 Windows Server 2012 R2](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacityPlanning.xlsx)或[AD FS 容量规划大小调整电子表格适用于 Windows Server 2016](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacity2016.xlsx)。
  
2.  在右侧的单元格**在峰值系统使用情况期间，我希望我的用户进行身份验证此百分比**单元格，单击的单元格，然后使用下拉\-向下箭头选择预计的系统利用率级别，或者**40%** ， **60%** 或**80%** 部署。  
  
3.  在右侧的单元格**以下时间内**单元格，单击的单元格，然后使用下拉\-向下箭头可以选择**1 分钟**， **15 分钟**，或**1 小时**若要选择的峰值负载持续时间。  
  
4.  在右侧的单元格**Enter 估计的内部应用程序数\(SharePoint 等\(2007年或 2010年\)或声明感知 web 应用程序\)** 单元中，键入的号码内部应用程序将在你的组织。  
  
5.  在右侧的单元格**Enter 估计的在线应用程序数\(如 Office 365 Exchange Online、 SharePoint Online 或 Lync Online\)** 单元中，键入联机应用程序数或服务将在组织中使用。  
  
6.  在标题为的单元格**用户数**，将需要输入数字，适用于应用程序方案示例用户的每一行上单一登录\-对的访问权限。 此列应包含定义的用户，不是每秒的峰值用户数。 如果通过主领域发现页面必须先转到应用程序进行的访问尝试，请键入**Y**。如果您不确定此选择，请键入**Y**。  
  
7.  请查看以下建议提供的值：  
  
    1.  建议的联合身份验证服务器的总数，请参阅较低的右边存储单元，以灰色突出显示。  
  
    2.  建议对每个示例应用程序方案的服务器数量，请参阅以灰色突出显示的行上的单元格。  
  
> [!NOTE]  
> 将自动计算中标题为的单元格右侧的单元格的值**的建议的联合身份验证服务器总数目**电子表格的底部包含一个公式这将添加到的其他 20%缓冲区在每个其前面的单个行中的所有值的总数。 添加到该公式**的建议的联合身份验证服务器总数目**生成到总建议数已部署的联合服务器以使其不太可能场上的总体负载将不断遇到此缓冲区中的单元格其饱和度点。  
  
## <a name="see-also"></a>请参阅
[Windows Server 2012 中的 AD FS 设计指南](AD-FS-Design-Guide-in-Windows-Server-2012.md)
