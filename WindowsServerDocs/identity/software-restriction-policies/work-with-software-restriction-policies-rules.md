---
title: "适用于软件限制策略规则"
description: "Windows Server 安全"
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: security-software-restriction-policies
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 4a8047d5-9bb9-4bed-bc8f-583a237731e2
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/12/2016
ms.openlocfilehash: 2dd1810b50f4f02be99eb2e2c0893501f99d1e93
ms.sourcegitcommit: 70c1b6cedad55b9c7d2068c9aa4891c6c533ee4c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/03/2017
---
# <a name="work-with-software-restriction-policies-rules"></a>适用于软件限制策略规则

>适用于：Windows Server 2016，Windows Server 2012 R2、Windows Server 2012

本主题介绍的过程处理证书，路径和 internet 使用限制策略的软件的区域和希规则。

## <a name="introduction"></a>简介
使用软件的限制策略，可以从不受信任的软件保护你的计算环境，通过标识和指定允许哪种软件运行。 你可以定义的默认安全级别**无限制**或**不允许**的组策略对象 (GPO)，以便软件可以或不允许默认情况下运行。 你可以通过创建软件限制软件的特定策略规则进行例外此默认安全级别。 例如，如果的默认安全级别设置为**不允许**，你可以创建规则允许特定运行的软件。 类型的规则如下所示：

-   **证书规则**

    有关过程，请参阅[处理证书规则](#BKMK_Cert_Rules)。

-   **哈希规则**

    有关过程，请参阅[处理哈希规则](#BKMK_Hash_Rules)。

-   **Internet 时区规则**

    有关过程，请参阅[使用 Internet 的时区规则](#BKMK_Internet_Zone_Rules)。

-   **路径规则**

    有关过程，请参阅[处理路径规则](#BKMK_Path_Rules)。

有关其他任务管理限制策略的软件的信息，请参阅[管理软件限制策略](administer-software-restriction-policies.md)。

## <a name="BKMK_Cert_Rules"></a>使用规则证书
限制策略的软件还可以通过其签名证书标识软件。 你可以创建的证书规则标识软件和允许或不允许该软件运行，具体取决于安全级别。 例如，你可以使用证书规则自动不提示用户信任来自受信任来源的域中的软件。 你还可以使用证书规则运行的操作系统禁止区域中的文件。 默认情况下未启用证书规则。

使用组策略的域创建规则，你必须在创建或修改组策略对象的权限。 如果你要创建规则本地计算机，你必须管理凭据该计算机上。

#### <a name="to-create-a-certificate-rule"></a>若要创建证书规则

1.  打开限制策略的软件。

2.  在的控制台树或的详细信息窗格中，右键单击**其他规则**，然后单击**新证书规则**。

3.  单击**浏览**，然后选择某个证书或签名的文件。

4.  在**安全级别**，或者单击**不允许**或**无限制**。

5.  在**描述**，键入描述此规则，，然后单击**确定**。

> [!NOTE]
> -   可能需要创建新的软件限制策略设置的组策略对象 (GPO)，如果你没有。
> -   默认情况下未启用证书规则。
> -   仅受证书规则的文件类型都中列出的这些**指定的文件类型**软件限制策略的详细信息窗格中。 没有指定的文件类型由所有规则共享的一个列表。
> -   软件限制策略以使其生效，用户必须注销，然后登录到他们的计算机由更新策略设置。
> -   多个软件限制策略规则应用于策略设置，时处理冲突规则的设置。

### <a name="enabling-certificate-rules"></a>启用证书规则
有不同启用证书规则，具体取决于您的环境的步骤：

-   [有关本地计算机](#BKMK_1)

-   [对于组策略对象，并且你位于加入域的服务器](#BKMK_2)

-   [对于组策略对象，并且你位于某个域控制器或打开工作站，具有安装了远程服务器管理工具](#BKMK_3)

-   [仅对于域控制器，并且你是该域控制器上或在安装了远程服务器管理工具包的工作站上](#BKMK_4)

#### <a name="BKMK_1"></a>若要启用证书本地计算机规则

1.  打开本地安全设置。

2.  在控制台树中，单击**安全选项**位于安全设置中的本地策略下。

3.  在详细信息窗格中，双击**系统设置： 使用 Windows 软件的限制策略的可执行文件的证书规则**。

4.  执行下列情况之一，然后单击**确定**:

    -   若要启用证书规则，请单击**启用**。

    -   若要禁用证书规则，请单击**禁用**。

#### <a name="BKMK_2"></a>若要启用证书规则的组策略对象，并且你是已加入域的服务器上

1.  打开 Microsoft 管理控制台 (MMC)。

2.  在**文件**菜单上，单击**添加/删除管理单元在**，然后单击**添加**。

3.  单击**本地组策略编辑器**，然后单击**添加**。

4.  在**选择组策略对象**，单击**浏览**。

5.  在**浏览组策略对象**，选择相应的域、 网站或单位中的组策略对象 (GPO)-或创建一个新相册，然后单击**完成**。

6.  单击**关闭**，然后单击**确定**。

7.  在控制台树中，单击**安全选项**位于*GroupPolicyObject* [*ComputerName*] 策略中的计算机配置中的 Windows 设置中的安全设置月本地策略 /。

8.  在详细信息窗格中，双击**系统设置： 使用 Windows 软件的限制策略的可执行文件的证书规则**。

9. 如果尚未定义此策略设置，请选择**定义这些策略设置**复选框。

10. 执行下列情况之一，然后单击**确定**:

    -   若要启用证书规则，请单击**启用**。

    -   若要禁用证书规则，请单击**禁用**。

#### <a name="BKMK_3"></a>组策略对象，使证书规则，并且就域控制器上或在安装远程服务器管理工具的工作站上

1.  打开 Active Directory 用户和计算机。

2.  在控制台树中，右键单击你希望启用证书规则组策略对象 (GPO)。

3.  单击**属性**，然后单击**组策略**选项卡。

4.  单击**编辑**以打开你想要编辑的 GPO。 你还可以单击**新建**以创建一个新 GPO，然后单击**编辑**。

5.  在控制台树中，单击**安全选项**位于*GroupPolicyObject*[*ComputerName*] 策略中的计算机配置中的 Windows 设置中的安全设置中的本地策略。

6.  在详细信息窗格中，双击**系统设置： 使用 Windows 软件的限制策略的可执行文件的证书规则**。

7.  如果尚未定义此策略设置，请选择**定义这些策略设置**复选框。

8.  执行下列情况之一，然后单击**确定**:

    -   若要启用证书规则，请单击**启用**。

    -   若要禁用证书规则，请单击**禁用**。

#### <a name="BKMK_4"></a>若要启用证书仅域控制器和规则你是该域控制器上或在安装远程服务器管理工具的工作站上

1.  打开域控制器安全设置。

2.  在控制台树中，单击**安全选项**位于*GroupPolicyObject* [*ComputerName*] 策略中的计算机配置中的 Windows 设置中的安全设置中的本地策略。

3.  在详细信息窗格中，双击**系统设置： 使用 Windows 软件的限制策略的可执行文件的证书规则**。

4.  如果尚未定义此策略设置，请选择**定义这些策略设置**复选框。

5.  执行下列情况之一，然后单击**确定**:

    -   若要启用证书规则，请单击**启用**。

    -   若要禁用证书规则，请单击**禁用**。

> [!NOTE]
> 证书规则生效之前，你必须执行此过程。

### <a name="set-trusted-publisher-options"></a>设置受信任的发布者的选项
软件签名用于越来越多的软件的发布者和应用程序开发人员通过验证其应用程序来自受信任的源。 但是，许多用户无法理解或小注意到它们安装的应用程序关联的签名证书。

中的策略设置**受信任的发布者**证书路径验证策略的选项卡允许管理员，要控制哪些证书可接受为来自受信任的发布者。

##### <a name="to-configure-the-trusted-publishers-policy-settings-for-a-local-computer"></a>若要配置本地计算机的受信任的发布者策略设置

1.  在**开始**屏幕上，键入**gpedit.msc** ，然后按 ENTER。

2.  下的控制台树中**本地计算机策略配置 windows \ 设置**，单击**公钥策略**。

3.  双击**证书路径验证设置**，然后单击**受信任的发布者**选项卡。

4.  选择**定义这些策略设置**复选框、 选择你想要将该应用，然后单击的策略设置**确定**应用的新的设置。

##### <a name="to-configure-the-trusted-publishers-policy-settings-for-a-domain"></a>若要配置某个域受信任的发布者策略设置

1.  打开**组策略管理**。

2.  控制台树中，双击**组策略对象**林和域包含**默认域策略**组策略对象 (GPO) 你想要编辑。

3.  右键单击**默认域策略**GPO，，然后单击**编辑**。

4.  下的控制台树中**计算机配置 windows \ 设置**，单击**公钥策略**。

5.  双击**证书路径验证设置**，然后单击**受信任的发布者**选项卡。

6.  选择**定义这些策略设置**复选框、 选择你想要将该应用，然后单击的策略设置**确定**应用的新的设置。

##### <a name="to-allow-only-administrators-to-manage-certificates-used-for-code-signing-for-a-local-computer"></a>若要只允许管理员进行管理用于代码本地计算机签名证书

1.  在**开始**屏幕上，键入， **gpedit.msc**中**搜索程序和文件**或在 Windows 8，请打开桌面，并按 ENTER。

2.  下的控制台树中**默认域策略**或**本地计算机策略**，双击**计算机配置**， **Windows 设置**，并**安全设置**，然后单击**公钥策略**。

3.  双击**证书路径验证设置**，然后单击**受信任的发布者**选项卡。

4.  选择**定义这些策略设置**复选框。

5.  下**受信任的发布者管理**，单击**只允许所有管理员进行管理受信任的发布者**，然后单击**确定**应用的新的设置。

##### <a name="to-allow-only-administrators-to-manage-certificates-used-for-code-signing-for-a-domain"></a>若要只允许管理员进行管理用于代码域签名证书

1.  打开**组策略管理**。

2.  控制台树中，双击**组策略对象**林和域包含**默认域策略**你想要编辑的 GPO。

3.  右键单击**默认域策略**GPO，，然后单击**编辑**。

4.  下的控制台树中**计算机配置 windows \ 设置**，单击**公钥策略**。

5.  双击**证书路径验证设置**，然后单击**受信任的发布者**选项卡。

6.  选择**定义这些策略设置**复选框、 实现更改，然后单击**确定**应用的新的设置。

## <a name="BKMK_Hash_Rules"></a>使用希规则
哈希代码是一串唯一标识软件程序或文件的长度固定与字节。 哈希哈希算法通过计算。 当希规则地创建一种软件程序时，软件限制策略计算计划哈希代码。 当用户尝试打开一种软件程序时，该程序哈希代码软件限制策略的现有希规则进行比较。 一种软件程序哈希始终无论均将一致，这项计划在计算机上的位置。 但是，如果以任何方式更改是一种软件程序，其希也会更改，并且它不会再匹配哈希软件限制策略希规则中。

例如，你可以创建希规则，并将安全级别到设置**不允许**以防止用户运行某些文件。 可以重命名或移动到另一个文件夹中文件并且仍在同一希的结果。 但是，任何更改对文件本身还更改其希代码值，并允许限制绕过该文件。

#### <a name="to-create-a-hash-rule"></a>若要创建希规则

1.  打开限制策略的软件。

2.  在的控制台树或的详细信息窗格中，右键单击**其他规则**，然后单击**新希规则**。

3.  单击**浏览**要查找的文件。

    > [!NOTE]
    > 在 Windows XP 也可以粘贴中的预计算的希**文件希**。 在 Windows Server 2008 R2、 Windows 7 和更高版本，此选项不可用。

4.  在**安全级别**，或者单击**不允许**或**无限制**。

5.  在**描述**，键入描述此规则，，然后单击**确定**。

> [!NOTE]
> -   可能需要创建新的软件限制策略设置的组策略对象 (GPO)，如果你没有。
> -   病毒或特洛伊木马来阻止它们运行，可以创建希规则。
> -   如果你想要使用希规则，以便病毒无法运行其他人，通过使用软件限制策略，计算的病毒希，然后电子邮件发送给其他人哈希值。 永远不会电子邮件发送自身的病毒。
> -   如果已通过电子邮件发送病毒，你还可以创建路径规则防止执行的电子邮件附件。
> -   重命名或移动到另一个文件夹结果相同希中的文件。 在不同的哈希结果对文件本身的任何更改。
> -   仅受哈希规则的文件类型都中列出的这些**指定的文件类型**软件限制策略的详细信息窗格中。 没有指定的文件类型由所有规则共享的一个列表。
> -   软件限制策略以使其生效，用户必须注销，然后登录到他们的计算机由更新策略设置。
> -   多个软件限制策略规则应用于策略设置，时处理冲突规则的设置。

## <a name="BKMK_Internet_Zone_Rules"></a>使用 Internet 的时区规则
Internet 时区规则仅适用于 Windows Installer 包。 时区规则可识别从 Internet Explorer 通过指定某个区域的软件。 这些区域很 Internet、 本地 intranet、 受限制的站点、 受信任的站点和我的电脑。 Internet 时区规则专门用于阻止下载和安装软件的用户。

#### <a name="to-create-an-internet-zone-rule"></a>若要创建 Internet 时区规则

1.  打开限制策略的软件。

2.  在的控制台树或的详细信息窗格中，右键单击**其他规则**，然后单击**Internet 新的时区规则**。

3.  在**Internet 区域**，单击 Internet 区域。

4.  中**安全级别**，或者单击**不允许**或**无限制**，然后单击**确定**。

> [!NOTE]
> -   可能需要创建新的软件限制策略设置的组策略对象 (GPO)，如果你没有。
> -   时区规则仅适用于使用.msi 文件类型，这是 Windows 安装程序包的文件。
> -   软件限制策略以使其生效，用户必须注销，然后登录到他们的计算机由更新策略设置。
> -   多个软件限制策略规则应用于策略设置，时处理冲突规则的设置。

## <a name="BKMK_Path_Rules"></a>使用规则路径
路径规则文件路径来标识软件。 例如，如果你拥有的计算机，已的默认安全级别**不允许**，你仍可以授予为每位用户无限制到特定文件夹的访问权限。 你可以通过使用的文件路径和设置的安全级别路径规则应用于创建路径规则**无限制**。 这种规则一些常见的路径是 %userprofile%、 %windir%、 %应用 %、 %programfiles%和 %临时 %。 你还可以为其路径使用该软件的注册表项路径规则创建注册表。

因为这些规则指定的路径，如果移动一种软件程序时，不会再适用路径规则。

#### <a name="to-create-a-path-rule"></a>若要创建一条路径规则

1.  打开限制策略的软件。

2.  在的控制台树或的详细信息窗格中，右键单击**其他规则**，然后单击**新路径规则**。

3.  在**路径**、 键入路径，或者单击**浏览**要查找的文件或文件夹。

4.  在**安全级别**，或者单击**不允许**或**无限制**。

5.  在**描述**，键入描述此规则，，然后单击**确定**。

> [!CAUTION]
> -   在某些文件夹中，Windows 文件夹中，如设置的安全级别到**不允许**可能会对你的操作系统的运行负面影响。 请确保没有禁用的关键组件的操作系统或其相关程序之一。

> [!NOTE]
> -   可能需要创建新软件限制策略为组策略对象 (GPO)，如果你没有。
> -   如果你创建路径规则软件的安全级别**不允许**，用户仍可以通过将其复制到另一个位置运行该软件。
> -   受路径规则通配符都 * 和什么？
> -   你可以在路径规则使用环境变量，如 %programfiles%或 %系统根 %。
> -   如果你想要创建路径规则软件，当你不知道它存储在计算机上，但你有其注册表项，可以创建注册表路径规则。
> -   若要阻止用户执行电子邮件附件，可以创建你的电子邮件程序附件目录了阻止用户通过运行的电子邮件附件路径规则。
> -   仅受路径规则的文件类型都中列出的这些**指定的文件类型**软件限制策略的详细信息窗格中。 没有指定的文件类型由所有规则共享的一个列表。
> -   软件限制策略以使其生效，用户必须注销，然后登录到他们的计算机由更新策略设置。
> -   多个软件限制策略规则应用于策略设置，时处理冲突规则的设置。

#### <a name="to-create-a-registry-path-rule"></a>若要创建注册表路径规则

1.  在**开始**屏幕上，键入 regedit。

2.  控制台树中，右键单击你想要创建规则，然后单击的注册表项**复制项名称**。 请注意的详细信息窗格中的值名称。

3.  打开限制策略的软件。

4.  在的控制台树或的详细信息窗格中，右键单击**其他规则**，然后单击**新路径规则**。

5.  在**路径**，粘贴值名称后跟注册表名称。

6.  将于百分号 （%），例如 %hkey_local_machine\software\microsoft\platformsdk\directories\installdir%注册表路径。

7.  在**安全级别**，或者单击**不允许**或**无限制**。

8.  在**描述**，键入描述此规则，，然后单击**确定**。


