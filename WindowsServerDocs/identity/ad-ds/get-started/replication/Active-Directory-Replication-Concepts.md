---
ms.assetid: 4cc9c16c-1928-4dce-a3a8-6229be28eb65
title: "Active Directory 复制概念"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 45753c048f9bb1cb174daade1d408b88b3686b4b
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/12/2017
---
# <a name="active-directory-replication-concepts"></a>Active Directory 复制概念

>适用于：Windows Server 2016，Windows Server 2012 R2、Windows Server 2012

在之前设计站点拓扑，熟悉一些 Active Directory 复制概念。  
  
-   [连接对象](#BKMK_1)  
  
-   [KCC](#BKMK_2)  
  
-   [故障转移功能](#BKMK_3)  
  
-   [子网](#BKMK_4)  
  
-   [网站](#BKMK_5)  
  
-   [网站的链接](#BKMK_6)  
  
-   [网站的链接大桥](#BKMK_7)  
  
-   [网站的链接传递](#BKMK_8)  
  
-   [全球目录服务器](#BKMK_9)  
  
-   [通用组成员缓存](#BKMK_10)  
  
## <a name="BKMK_1"></a>连接对象  
连接对象是表示从源域控制器复制连接到目标域控制器 Active Directory 对象。 域控制器成员的一个网站，并由站点中通过 Active Directory 域服务 (广告 DS) 中的服务器对象。 每个服务器对象具有各自的对象表示复制域控制器站点中的孩子。  
  
连接对象是对象的各自目的地服务器上的孩子。 复制之间两个域控制器，服务器对象的其中一个必须连接一个表示从其他的入站的复制。 对于域控制器的所有复制连接都存储为各自的对象下的连接对象。 连接对象标识复制源服务器、 包含复制日程安排，并指定复制传输。  
  
知识一致性检查 (KCC) 会自动创建连接对象，但也可以手动创建。 创建者 KCC 连接对象显示在 Active Directory 站点和服务管理单元作为** <automatically generated> **和被认为提供妥善正常运行的情况下。 创建者管理员连接对象手动创建连接对象。 手动创建的连接对象标识创建时已由管理员分配的名称。 当你修改** <automatically generated> **连接对象转换修改以管理的方式连接对象和的对象将以以下形式出现 GUID 的出现。 KCC 不会对手动或修改连接对象进行更改。  
  
## <a name="BKMK_2"></a>KCC  
KCC 是一个内置的过程，可在所有域控制器上运行，并将生成复制拓扑 Active Directory 森林。 KCC 创建单独的复制拓扑，具体取决于是否复制正在之间 （站点间） 站点或在网站 （站点内）。 KCC 还动态调整拓扑以容纳添加新的域控制器，删除现有的域控制器，移动到和来自的站点、 更换成本和日程安排，域控制器和暂时不可用的域控制器或错误状态。  
  
在某个站点，可写的域控制器之间的连接始终排列在双向 ring，使用其他快捷方式连接减少在较大的站点的延迟。 另一方面，站点间拓扑是分层跨越树，这表示一个为每个目录分区任何两个的站点之间存在站点间连接，并且通常不包含快捷方式连接。 有关覆盖的树和 Active Directory 复制拓扑的详细信息，请参阅 Active Directory 复制 Technical 拓扑参考 ([https://go.microsoft.com/fwlink/?LinkID=93578](https://go.microsoft.com/fwlink/?LinkID=93578))。  
  
在每个域控制器，KCC 通过创建单向站的连接对象的定义来自其他域控制器连接来创建复制路线。 对于域控制器在同一站点，KCC 创建自动没有管理介入连接对象。 当你有多个站点时，配置站点的站点之间的链接，并在各个站点的单个 KCC 自动创建以及的站点之间的连接。  
  
### <a name="kcc-improvements-for-windows-server-2008-rodcs"></a>对于 Windows Server 2008 Rodc KCC 改进  

有多种 KCC 改进，以适应 Windows Server 2008 的新型推出的仅阅读域控制器 (RODC)。 RODC 的典型部署情况是分支机构。 最常见的部署在这种情况下 Active Directory 复制拓扑基于中心分支设计，位置 branch 域控制器在多个站点复制桥头服务器中心站点中的一小部分。  
  
在此情况下部署 RODC 的优势是单向复制。 桥头服务器不可需要复制从 RODC，减少了管理和网络的情况。  
  
但是，在以前版本的 Windows Server 操作系统的星拓扑由突出显示的一个管理难题是，在中心添加新的桥头域控制器后, 没有自动机制重新分发分支域控制器和中心域控制器，来充分利用新的中心域控制器之间复制连接。  
  
对于 Windows Server 2003 域控制器，你可以重新工作负载平衡使用工具，例如 Adlb.exe 从 Windows Server 2003 年分支机构部署指导 ([https://go.microsoft.com/fwlink/?LinkID=28523](https://go.microsoft.com/fwlink/?LinkID=28523))。  
  
对于 Windows Server 2008 Rodc，正常工作的 KCC 提供一些重新平衡，这就无需使用如 Adlb.exe 其他工具。 默认情况下，启用新的功能。 您可以禁用它加上 RODC 设置以下注册表项：  
  
**HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters**  
  
**"随机 BH 负载平衡允许"**  
**1 = 启用 （默认），0 = 禁用**  
  
有关这些 KCC 改进的工作原理的详细信息，请参阅规划和部署的 Active Directory 域服务对于分公司 ([https://go.microsoft.com/fwlink/?LinkId=107114](https://go.microsoft.com/fwlink/?LinkId=107114))。  
  
## <a name="BKMK_3"></a>故障转移功能  
站点确保该复制路由周围网络故障和离线状态下的域控制器。 KCC 指定的时间间隔，若要调整发生的广告 DS 更改的复制拓扑在运行时，例如，在添加了新的域控制器和新创建网站。 KCC 要审查复制连接状态的现有以确定任何连接均不起作用。 如果连接无法正常由于故障的域控制器，KCC 自动版本临时连接到其他复制合作伙伴 （如果可用） 以确保该复制发生。 如果网站的所有域控制器都不可用，KCC 会自动创建复制域控制器，从另一台的站点之间的连接。  
  
## <a name="BKMK_4"></a>子网  
子网是一套逻辑 IP 地址分配给网络 TCP/IP 一段。 个子网分组计算机标识网络上的实际距离的方式。 在广告 DS 子网对象识别用于映射到站点计算机的网络地址。  
  
## <a name="BKMK_5"></a>网站  
站点是表示一个或多个 TCP/IP 子网具有高的可靠性和 fast 网络连接的 Active Directory 对象。 网站信息允许管理员配置了 Active Directory 访问和复制优化物理网络使用情况。 与一套子网相关联站点对象以及森林中的每个域控制器程序与它的 IP 地址根据 Active Directory 站点。 站点能够承载从多个域，域控制器，而且可以在多个站点表示域。  
  
## <a name="BKMK_6"></a>网站的链接  
网站的链接是代表 KCC 用于建立连接的 Active Directory 复制的逻辑路径的 Active Directory 对象。 站点链接对象表示站点，可以通过指定的站点间传输统一成本通信一的组。  
  
包含在网站链接内的所有站点都视为连接通过网络类型都相同。 网站必须手动链接到其他网站使用网站的链接，以便在一个站点域控制器可以从其他站点中域控制器复制目录的更改。 因为站点链接到复制期间由网络数据包物理网络上的实际路径不符，你不需要建立冗余网站的链接，以改进 Active Directory 复制效率。  
  
当由网站链接连接两个站点时，复制系统会自动创建称为桥头服务器的特定的域控制器在每个站点之间的连接。 在 Windows Server 2008、 站点中托管同一目录分区的所有域控制器为所选为桥头服务器都的候选项。 创建者 KCC 复制连接随机分布在站点共享复制工作负载中的所有候选桥头服务器。 默认情况下，进程所执行的随机的选择放置后仅当连接对象首次添加到相关站点。  
  
## <a name="BKMK_7"></a>网站的链接大桥  
其网站的所有站点链接大桥是代表站点链接的一组 Active Directory 对象时，通过使用常见传输可以通信。 网站的链接桥启用未通过将其复制彼此的通信链接直接连接的域控制器。 通常，网站链接大桥对应于路由器 （或一组路由器） IP 网络上。  
  
默认情况下，KCC 可以通过形成一个可传递路由有何共同点的某些站点的所有站点链接。 如果此问题已禁用，每个站点链接表示自己独特的隔离的网络。 通过站点链接大桥表示的站点链接将视为一个路线集。 每个大桥表示网络通信的独立的通信环境。  
  
网站的链接桥是机制逻辑代表传递站点之间的物理连接。 网站的链接大桥允许 KCC 使用包含的站点链接的任意组合，以确定互连目录分区保留在这些站点的最便宜路线。 网站的链接大桥不提供实际连接到域控制器。 如果网站的链接大桥将被删除，直到 KCC 删除链接将继续通过组合的站点链接复制。  
  
网站链接桥才必须某个站点包含主持也不域控制器在邻近的站点托管目录分区域控制器，但域控制器举办目录分区位于森林中的一个或多个其他网站。 邻近站点被定义为包含在单个站点链接任何两个或多个站点。  
  
网站的链接大桥创建之间两个网站的链接，提供了一种可传递路径通过临时网站的两个断开连接状态的站点之间的逻辑连接。 如果出于站点间拓扑 generator (ISTG)，这座大桥通过使用的临时站点意味着物理连接。 这座大桥并不意味着域控制器临时站点中的将提供复制路径。 但是，这可能是这种情况，如果临时站点包含托管要复制的目录分区域控制器，这种情况下站点链接大桥不需要。  
  
添加站点的每个链接的费用，创建的总和的开销生成的路径。 如果临时站点不包含举办目录分区域控制器，并且更低的费用链接不存在，会使用站点链接大桥。 如果临时站点包含承载目录分区域控制器，设置复制连接到临时域控制器，使用这座大桥两个断开连接状态的站点。  
  
## <a name="BKMK_8"></a>网站的链接传递  
默认情况下所有站点链接都是传递，或"过渡。" 当有桥网站的链接并计划重叠时，KCC 创建复制连接，以确定位置站点未被站点链接直接连接，但间接连接通过常用站点一组的站点之间的域控制器复制合作伙伴。 这意味着你可以通过结合使用的站点链接的任何其他网站到连接的任何站点。  
  
一般情况下，对于完全路由的网络，你不需要创建的任何站点桥链接，除非你想要控制复制更改流。 如果不完全路由你的网络，应创建站点链接桥以避免无法复制尝试。 对于特定传输的所有站点链接隐式都属于为该传输单个站点链接大桥。 网站的链接默认桥自动，并且没有 Active Directory 对象表示该大桥。 **桥所有站点链接**设置，请在属性 IP 和简单邮件传输协议 (SMTP) 的站点间传输容器找到实现桥自动站点链接。  
  
> [!NOTE]  
> SMTP 复制将不受支持的广告 DS; 未来版本中因此，不建议 SMTP 容器在创建网站链接对象。  
  
## <a name="BKMK_9"></a>全球目录服务器  
全球目录服务器是将所有对象的信息存储在森林，域控制器，以便没有作出存储请求的数据的特定的域控制器，应用程序可以搜索广告 DS。 所有域控制器，如全球目录服务器存储完整，可写的方案和配置目录分区的副本和完整，可写它承载域域目录分区的副本。 此外，全球目录服务器存储林中部分、 仅阅读所有其他域的副本。 部分、 只读域副本包含在域，但只属性 （通常用于搜索的对象这些属性） 子集每对象。  
  
## <a name="BKMK_10"></a>通用组成员缓存  
通用组成员缓存允许到缓存通用组成员的信息，以便用户在该域控制器。 你可以启用域控制器正在运行 Windows Server 2008 缓存通用的组成员身份使用 Active Directory 站点和服务管理单元。  
  
启用通用组成员缓存不必在每个在某个域，因为不需要将所有林中对象复制域控制器网络带宽使用量最大程度减少站点全球目录服务器。 它还可以减少登录的时间，因为身份验证的域控制器并不总是需要访问全球目录来获取通用组成员的信息。 有关何时使用通用组成员缓存的详细信息，请参阅[规划全局目录 Server 放置](../../../ad-ds/plan/Planning-Global-Catalog-Server-Placement.md)。  
  


