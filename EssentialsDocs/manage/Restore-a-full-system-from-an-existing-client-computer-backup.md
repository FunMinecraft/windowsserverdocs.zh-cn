---
title: "从现有的客户端计算机备份中还原完整系统"
description: "介绍了如何使用 Windows Server Essentials"
ms.custom: na
ms.date: 10/03/2016
ms.prod: windows-server-2016-essentials
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 47e498a6-1b71-47de-88f6-8c13c221d108
author: nnamuhcs
ms.author: coreyp
manager: dongill
ms.openlocfilehash: cfc4d1ce461e1e1cbb9b99970355c4dc7241911b
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/12/2017
---
# <a name="restore-a-full-system-from-an-existing-client-computer-backup"></a>从现有的客户端计算机备份中还原完整系统

>适用于：Windows Server 2016 Essentials，Windows Server 2012 R2 Essentials 中，Windows Server 2012 Essentials 
  
 硬件和操作系统失败少见，但它们可能会发生。 不能正常工作的爱好者可能过热计算机母板，而使其无法使用。 操作系统可能会损坏，拒绝开始。 灰烬和水损坏可能会导致永久硬件损坏。 硬盘上可能失败，或者你可能决定将其替换为较大的硬盘驱动器。  
  
 本文介绍了有关以下主题：  
  
-   [计算机的全系统恢复是什么？](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_WhatIs)  
  
-   [系统还原环境如何工作？](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_HowDoes)  
  
-   [创建可启动 U 盘客户端计算机还原](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_CreateBootable)  
  
-   [使用全系统恢复向导](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_Using)  
  
-   [在哪里可以找到我的硬件的驱动程序？](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_FindDrivers)  
  
##  <a name="BKMK_WhatIs"></a>计算机的全系统恢复是什么？  
 在你会替换硬盘驱动器或点它不能用于或无法启动你的计算机无法正常工作，可以从计算机的以前的备份中还原系统。 全系统恢复返回到备份的时间位于的状态的系统。  
  
> [!IMPORTANT]
>  你无法上计算机的硬件，如主板，不是类似与被替换计算机硬件执行完整的系统还原。 已安装的操作系统基础的计算机的硬件上密切属于。 但是，你可以执行的大小等于或大于那个被替换硬盘驱动器完整的系统还原。  
  
 在执行完整的系统还原，你可以选择特定计算机备份中还原系统，所有熟悉之前故障、灾难或被盗用户的设置、应用程序和配置。 你还可以选择你想要还原的卷。  
  
 在规划或准备到网络计算机还原完整的系统，考虑以下：  
  
### <a name="windows-preinstallation-environment"></a>Windows 预安装环境  
 Windows 预安装环境 (Windows PE) 是旨在准备 Windows 安装一台计算机最少的操作系统。 对于运行 Windows Server Essentials 服务器，Windows PE 自动安装在你插入恢复媒体要还原的计算机上。 对于运行 Windows Server Essentials 服务器、Windows PE 安装自动与客户端还原服务或 U 盘启动计算机时。  
  
 Windows PE 不支持无线连接。 出于此原因，还原的计算机必须物理连接到小型企业网络。  
  
### <a name="bitlocker"></a>BitLocker  
 BitLocker 驱动器加密 (BitLocker) 是 Windows Vista、Windows 7 和 Windows 8 的某些版本中提供的数据保护功能。 BitLocker 防止数据被盗或计算机上，会丢失或被盗，曝光度并提供更安全删除的数据会停止使用计算机时。  
  
 **Windows Server essentials:**如果使用 BitLocker（无论是只需操作系统驱动器或操作系统驱动器和一个或其他固定的多个驱动器）加密的计算机，你需要还原，你仍然可以使用包含在附带服务器和全屏系统还原向导中的 CD 上的全系统还原媒体重新安装硬盘驱动器图像包括操作系统从备份和还原到新的或已修复的计算机的数据。  
  
 **Windows Server essentials:**如果使用 BitLocker（无论是只需操作系统驱动器或操作系统驱动器和一个或其他固定的多个驱动器）加密的计算机，你需要还原，仍可以使用全系统恢复向导来重新安装硬盘驱动器图像，包括操作系统从备份和还原到新的或已修复的计算机的数据。  
  
 服务器备份驱动器、文件夹和文件，当到服务器保存的加密的版本。 在整个系统还原未加密的此版本被复制到计算机。  
  
> [!NOTE]
>  成功的全系统恢复后，你必须重新 BitLocker 激活在计算机上。  
>   
>  有关如何在运行 Windows 8 计算机上启用 BitLocker 的说明，请参阅[BitLocker：如何启用 BitLocker](https://go.microsoft.com/fwlink/p/?LinkID=254918)。  
>   
>  有关如何在运行 Windows 7 的计算机上启用 BitLocker 的说明，请参阅[BitLocker 驱动器加密 Step-by-Step Windows 7 的指南](https://go.microsoft.com/fwlink/p/?LinkId=140225)。  
  
 有关 BitLocker 驱动器加密基本操作的详细信息，请参阅[BitLocker 常见问题要求问题（常见问题）](https://go.microsoft.com/fwlink/p/?LinkID=254917)。  
  
### <a name="encrypting-file-system-encrypted-files"></a>加密文件系统加密文件  
 Windows 中的加密文件系统 (EFS) 功能可以提供其他基于用户的文件的不同的多个用户间的安全级别的同一台计算机的级别加密。 请务必注意，与 BitLocker 加密的驱动器，不同 EFS 加密的文件夹和文件继续中的任何计算机备份加密。 EFS 不适用于 Windows XP Home Edition、Windows Vista 简易版、Windows Vista 家庭普通版、Windows Vista 家庭高级版、Windows 7 简易版、Windows 7 家庭普通版、Windows 7 家庭高级版或 Windows 8。 将仅适用于 Windows 8 专业版。  
  
> [!WARNING]
>  与不同 BitLocker，你只能访问从加密它们的操作系统中的 EFS 受保护的文件。  
  
### <a name="disk-partitions"></a>磁盘分区  
 如果在新计算机上的硬盘大小相同或大于、原始、硬自动重新格式化，并重新分配的磁盘驱动器。 请参阅下表中的详细信息：  
  
|原始计算机|还原或新计算机|  
|-----------------------|------------------------------|  
|有多个分区单个磁盘|具有多个分区和任何额外空间单个磁盘分配的最后一分区|  
|通过单个分区单个磁盘|使用单个分区，，并且所有可用空间的单个磁盘用于单个分区|  
  
> [!NOTE]
>  如果磁盘大小和分区布局之间有差异原始和还原或新计算机，你必须使用磁盘管理还原或新计算机上创建相应分区。 你可以在完整系统还原向导执行此操作。  
  
### <a name="raid-and-dynamic-disks"></a>RAID 和动态磁盘  
 备份冗余深刻的独立磁盘 (RAID) 和动态磁盘不受支持。  
  
##  <a name="BKMK_HowDoes"></a>系统还原环境如何工作？  
 附带 Windows ServerÂ® 2012 Essentials 的系统恢复媒体在计算机上安装 Windows 预安装环境 (Windows PE)。 Windows PE 替换 MS-DOS 环境，它包含适用于 Windows 的核心程序文件。 在 Windows Server Essentials 有两个受支持的方式来还原系统：使用客户端恢复服务，这使用的网络，不依赖于媒体，或使用 U 盘。  
  
> [!NOTE]
>  Windows PE 不支持无线连接。 出于此原因，还原的计算机必须物理连接到小型企业网络。  
  
 系统还原环境附带了 (x86) 32 位和 64 位 (x64) 程序文件。 还原介质插入系统后，选择适当版本的文件。 32 位 (x86) 默认值，并且如果您不选择 30 秒内自动选择。 如果有更新的全系统还原计划服务器上的文件，请更新的文件会自动下载到计算机。  
  
 预安装环境已设置后，将启动完整系统还原向导。 该向导将帮助你从之前的备份中还原你的计算机。 你还可以使用系统还原环境备份还原到新计算机相似的硬件。  
  
 在大多数情况下，程序文件和系统恢复环境中包含的驱动程序会重新启动新的或还原计算机所需的所有。 具体取决于新的或还原计算机的硬件，可能不包含存储的所有系统还原环境，并网络适配器驱动程序所需重新启动新的或还原计算机时。 完全系统还原向导中，您机会安装驱动程序，如有必要。 有关查找你的硬件的驱动程序的信息，请参阅[在哪里可以找到驱动程序用于我的硬件？](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_FindDrivers). 有关如何使用系统还原媒体信息，请参阅[使用全系统恢复向导](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_Using)。  
  
##  <a name="BKMK_CreateBootable"></a>创建可启动 U 盘客户端计算机还原  
 如果你需要先从现有的备份中还原客户端计算机，但是找不到还原 CD 预装（在 Windows Server Essentials) 服务器或不希望设置上（在 Windows Server Essentials) 服务器的客户端恢复服务，则可以创建可启动 U 盘。 然后你可以使用 U 盘启动客户端计算机和还原系统。 你使用的 U 盘大小必须至少为 1GB 或更大。  
  
#### <a name="to-create-a-bootable-usb-flash-drive"></a>若要创建可启动 U 盘  
  
1.  打开**仪表板**。  
  
2.  单击**设备**选项卡。  
  
3.  在**任务**窗格中，单击**自定义计算机备份和文件历史记录设置**。  
  
    > [!NOTE]
    >  在 Windows Server Essentials、单击**客户端计算机备份任务**。  
  
4.  单击**工具**选项卡，然后单击**创建密钥**中**计算机恢复**部分。 创建计算机恢复密钥向导将打开。  
  
5.  插入 1 GB 或者变得更大 USB 盘服务器上，然后按照向导中的说明进行操作。  
  
    > [!CAUTION]
    >  U 盘上的所有数据将被都删除。  
  
##  <a name="BKMK_Using"></a>使用全系统恢复向导  
 使用恢复成功后媒体、客户端恢复服务或 U 盘启动计算机和验证显示所有在还原或新的客户端计算机上，全系统恢复向导将加载驱动程序的硬件。 该向导将使您能够访问该服务器、计算机备份和源卷你想要还原到计算机，并执行实际恢复过程。  
  
> [!NOTE]
>   Windows Server 软件包不支持以下还原方案：  
>   
>  -   还原到统一可扩展固件接口 (UEFI) 的主启动录制 (MBR) 磁盘基于计算机。  
> -   正在 UEFI/GPT 备份还原到 BIOS 系统。  
>   
>  如果还原数据任一这些情况下，你将无法启动系统。 此外，你可能无法使用两千兆的大小大于的硬盘。  
  
 **先决条件：**  
  
-   先的全系统恢复过程，请使用网络电缆（有线连接）将计算机连接到相同网络的服务器。 请确保你具有访问客户端计算机上的所有硬盘。  
  
    > [!WARNING]
    >  请不要尝试执行完整系统还原到的计算机使用无线连接到该网络。  
  
-   如果你知道指示计算机缺少重要的网络或存储设备驱动程序，你将需要找到并开始全面的系统还原前到盘复制这些驱动程序。 Windows Server essentials：如果你使用的 CD 提供的全系统恢复媒体，该光盘必须残留驱动器中的开始部分的全系统恢复过程。 因此，除非你已第二个 CD/DVD 驱动器，否则不应复制到 CD 或 DVD 丢失的驱动程序。 而是将丢失的驱动程序复制到 U 盘。  
  
     有关如何查找你计算机的驱动程序的信息，请参阅[在哪里可以找到驱动程序用于我的硬件？](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_FindDrivers)  
  
-   Windows Server essentials：如果你找不到 Windows Server Essentials 还原 CD，则可以创建可启动 U 盘。 有关详细信息，请参阅[创建可启动 U 盘客户端计算机还原](Restore-a-full-system-from-an-existing-client-computer-backup.md#BKMK_CreateBootable)。  
  
#### <a name="to-use-the-full-system-restore-wizard"></a>若要使用的全系统恢复向导  
  
1.  请执行以下任一操作：  
  
    -   Windows Server 软件包：打开客户端计算机你想要还原，插入恢复媒体，然后关闭计算机。  
  
         再次打开计算机和期间电源上自行测试（文章），按相应的功能键（F 键）来访问启动设备菜单，然后依次选择 CD/DVD 驱动器。 Windows 引导管理器的启动。  
  
    -   Windows Server 软件包：如果你使用的客户端恢复服务，请重新启动计算机使用**启动从网络**选项。 否则，启动计算机使用 U 盘。  
  
         再次打开计算机和期间电源上自行测试（文章），按相应的功能键（F 键）来访问启动设备菜单，然后选择**启动从网络**（或者你可以选择从 U 盘启动）。 Windows 引导管理器的启动。  
  
    > [!NOTE]
    >  查看你的计算机制造商，以确定哪些功能键访问启动设备菜单中的文档。  
  
2.  计算机还原媒体包含 (x86) 32 位和 64 位 (x64) 启动选项。 在 Windows 启动管理器中，选择**完整系统还原 (x86)**或**完整系统还原 (x64)**。 如果计算机的硬件驱动程序 32 位，请选择 x86;如果他们 64 位，请，选择 x64。 加载 Windows 文件，并对完整的系统还原向导执行检查，以确保所有硬件的驱动程序可用。  
  
3.  在**完整系统还原向导**窗口中，选择您的首选的语言，然后单击箭头。  
  
4.  选择相应**时间和货币格式**，并**键盘或输入的法**此计算机。 单击**继续**。  
  
5.  如果缺少驱动程序，将显示消息恢复过程无法验证驱动程序。 单击**关闭**，然后在欢迎对话框中单击**加载驱动程序**。  
  
    1.  在**检测硬件**对话框中，单击**安装驱动程序**。  
  
    2.  插入 U 盘，其中包含硬件的驱动程序，然后在**安装驱动程序**对话框中，单击**扫描**。  
  
    3.  在**安装驱动程序**对话框中，单击**确定**找到驱动程序的时间。  
  
    4.  在**检测硬件**对话框中，单击**继续**。  
  
6.  如果在初始查看发现所有驱动程序，或安装所有关键驱动程序，请在**完整系统还原**窗口中，单击**继续**。  
  
7.  在**欢迎全系统恢复向导**页上，单击**下一步**。  
  
8.  该向导搜索你的服务器。  
  
    1.  向导找不到服务器，如果您有选项，再次搜索或输入服务器的 IP 地址。  
  
    2.  如果未检测到多个服务器，你需要选择其中一个。  
  
    3.  如果你服务器位于**登录到 < YourServerName\ >**页面的显示方式。  
  
9. 在**登录到 < YourServerName\ >**页上，键入*< AdministratorAccountName\ >*中**User name**文本框中，并且在管理员帐户密码**密码**文本框中，然后单击**下一步**。  
  
    > [!IMPORTANT]
    >  你必须使用管理员帐户创建在英语版本中。 如果你没有其中一个，然后你必须创建新管理员帐户。 若要执行此操作，第一次打开**用户**服务器仪表板上的选项卡、接下来设置键盘语言格式英文版本，并运行**添加用户帐户**创建管理员帐户的任务。 接下来，使用新管理员帐户继续客户端计算机还原。  
  
10. 在**选择要还原的计算机**页上，选择你想要还原，然后单击的计算机**下一步**。 你可以选择**< ComputerName\ >:（这台计算机）**选择另一台计算机上的网络或**另一台计算机**下拉列表。  
  
    > [!NOTE]
    >  如果这是服务器（例如，新的或重新安排用途的计算机），无法识别的计算机**这台计算机**不显示选项。  
  
11. 在**选择要还原的备份**页上，查看可用备份列表，选择你想要还原到计算机。  
  
    > [!NOTE]
    >  建议你选择成功（绿色选中）的备份。 这有助于确保成功还原系统和数据的所有文件。  
  
12. (*可选*)选择备份，然后单击**详细信息**打开**备份的详细信息**页面，并查看该备份有关详细信息。 上使用的信息**备份的详细信息**页面进行比较多个备份并帮助您确定哪个备份是最佳选择。 单击**关闭**上**备份的详细信息**页面，以返回到**选择要还原的备份**页面。  
  
13. 在**选择要还原的备份**页上，选择一个备份，然后单击**下一步**按钮。  
  
14. 在**选择恢复选项**页上，单击下列情况之一，然后单击**下一步**。  
  
    > [!NOTE]
    >  如果不支持自动分区未显示此页面。  
  
    1.  **让完全还原计算机（推荐）向导**。 此选项可帮助确保计算机还原到它时所的时间和所选的备份日期之前的状态。 如果您选择此选项，则跳至步 15。  
  
    2.  **让我选择要还原卷（高级）**。 此选项允许你选择你想要还原的卷和你想要还原它们。 你还可以在硬盘上创建分区。  
  
15. 在**选择要还原的卷**页上，你可以选择你想要还原的卷。  
  
    > [!NOTE]
    >  如果有多个硬盘备份源在计算机上，或者还原目标驱动器有比备份源驱动器的存储空间较少，此页面的显示方式。  
  
    1.  尝试匹配的源代码和目标卷向导。 你应该验证默认映射正确无误。  
  
        1.  若要取消选择卷，请单击该卷，列表菜单箭头，然后单击**无**。  
  
        2.  当你完成选择卷时，请单击**下一步**。  
  
    2.  如果源音量和目标卷相同的大小，或如果源的大小小于目标，绿色箭头显示两者之间。 如果（在源音量大于目标卷）音量大小不匹配，而红色 X 显示之间源代码和目的地。  
  
        > [!NOTE]
        >  如果，也会显示红色 X:  
        >   
        >  -   源音量磁盘星大小不匹配目标卷磁盘星大小。 如果你使用具有不同星大小，磁盘替代物理磁盘，或配置（这可能具有不同扇区大小大于物理磁盘该）的存储空间，发生这种。  
        > -   联系群集数量限制。 若要还原到目标卷源音量，必须格式化目标卷与群集大小源音量相同。 如果目标卷来说太大，并群集大小是否太小，你可以访问群集数量限制。  
  
        1.  单击**运行磁盘管理器（高级）**，并创建新的卷的大小相同的系统保留音量。  
  
            > [!NOTE]
            >  如果计算机客户端是统一可扩展固件接口 (UEFI) 基于，则必须使用**diskpart**工具，用于初始化系统的磁盘。 若要执行此操作，请打开运行的 command 窗口（按 Ctrl + Alt + Shift 5 秒钟 WinPE 环境中），**diskpart.exe**，然后运行 diskpart 以下命令：  
            >   
            >  1.  **DISKPART > 列表磁盘**  
            > 2.  **DISKPART > 选择磁盘 #***< disk\ >*  
            > 3.  **DISKPART > 干净**  
            > 4.  **DISKPART > 转换 gpt**  
            > 5.  **DISKPART > 创建分区 efi 大小 =***100* (其中*100*是示例分区大小以 mb 为单位，应原始分区相同)  
            > 6.  **DISKPART > 创建 msr 分区的大小 =***128* (其中*128*是示例分区大小以 mb 为单位，应原始分区相同)  
            > 7.  **DISKPART > 退出**  
  
        2.  *（可选）*选择选项**未分配驱动器号或驾车路径**。  
  
        3.  格式化卷作为**NTFS**。  
  
        4.  完成格式化后，新的系统音量，右键单击，然后单击**标记为活动的分区**。  
  
        5.  如果需要额外的卷对应的备份中的其他卷，请重复步骤*ii*通过*iv*以创建和激活卷，然后关闭**磁盘管理**。  
  
        6.  在**选择要还原的卷**页，映射系统保留备份到步中创建的大小相同的音量源的音量*v*。  
  
        7.  映射到相应的目标卷所有其他来源卷。  
  
        8.  单击**下一步**继续进行还原。  
  
16. 在**确认卷还原**页上，查看地图，，然后单击**下一步**。 如果你需要进行任何更改，请单击**重新**，然后重复步骤 14。  
  
17. **还原 < ComputerName\ > < 的日期和时间 backup\ > 从**页面报告的进度恢复过程。  
  
18. 在**还原成功完成**页、删除恢复媒体，然后单击**完成**。 重启计算机。  
  
    > [!IMPORTANT]
    >  如果之前还原计算机上启用 BitLocker 驱动器加密，你必须计算机重新启动后手动启用 BitLocker。  
  
##  <a name="BKMK_FindDrivers"></a>在哪里可以找到我的硬件的驱动程序？  
 具体取决于新的或还原计算机的硬件，可能不包含存储的所有恢复媒体，并网络适配器驱动程序所需重新启动还原的计算机时。 必须确定哪些驱动程序丢失、现有的媒体或制造商网站上找到这些驱动程序、将其复制到盘，然后将它们从盘复制到新或还原计算机时运行全系统恢复向导。  
  
 备份计算机后，在备份中保存计算机的驱动程序。 如果恢复媒体不包括驱动程序所需的所有，可以打开该计算机的备份，然后将驱动程序复制到 U 盘。  
  
#### <a name="to-copy-drivers-from-a-backup-to-a-usb-flash-drive"></a>若要从备份的驱动程序复制到 U 盘  
  
1.  在另一台计算机上，打开仪表板。  
  
2.  单击**设备**，然后单击计算机需要驱动程序和。  
  
3.  单击**还原文件或文件夹的计算机**。 还原文件或文件夹向导将打开。  
  
4.  单击最新的成功备份，然后单击**下一步**。  
  
5.  单击以打开，然后单击音量**下一步**。 打开的窗口，其中的文件和文件夹的备份中列出。  
  
6.  在计算机上的 USB 接头插入 U 盘，然后将驱动程序的全系统恢复文件夹复制到 U 盘。  
  
    > [!NOTE]
    >  你可能需要单击**向上一级**直至到达向系统卷根。  
  
7.  删除盘，，然后将其插入你要还原计算机。  
  
 你可以使用 U 盘时将其还原对你的计算机上安装驱动程序。 还原文件或文件夹向导查找此 U 盘上的其他驱动程序时使用的全系统还原向导。 你是最有可能需要驱动程序的网络适配器驱动程序和存储设备驱动程序。  
  
## <a name="see-also"></a>请参阅  
  
-   [管理备份和还原](Manage-Backup-and-Restore-in-Windows-Server-Essentials.md)  
  
-   [管理 Windows Server Essentials](Manage-Windows-Server-Essentials.md)
